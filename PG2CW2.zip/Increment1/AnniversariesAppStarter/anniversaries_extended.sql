DROP DATABASE IF EXISTS anniversaries;
CREATE DATABASE IF NOT EXISTS anniversaries DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
USE anniversaries;

DROP TABLE IF EXISTS ANNIVERSARY;
CREATE TABLE IF NOT EXISTS ANNIVERSARY (
  ANNIVERSARYID int(11) NOT NULL AUTO_INCREMENT,
  MODERNGIFT varchar(30) NOT NULL,
  TRADGIFT varchar(30) NOT NULL,
  PRIMARY KEY (ANNIVERSARYID)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;

INSERT INTO ANNIVERSARY (ANNIVERSARYID, MODERNGIFT, TRADGIFT) VALUES
(1, 'Clocks', 'Paper'),
(2, 'China', 'Cotton'),
(3, 'Glass/Crystal', 'Leather');

DROP TABLE IF EXISTS PLACE;
CREATE TABLE IF NOT EXISTS PLACE (
  PLACEID int(11) NOT NULL AUTO_INCREMENT,
  PLACENAME varchar(30) NOT NULL,
  COUNTRY varchar(30) NOT NULL,
  ANNIVERSARYID int(11) NOT NULL,
  PRIMARY KEY (PLACEID)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;

INSERT INTO PLACE (PLACEID, PLACENAME, COUNTRY, ANNIVERSARYID) VALUES
(1, 'Paris', 'France', 1),
(2, 'London', 'England', 1),
(3, 'Manchester', 'England', 1),
(4, 'Barcelona', 'Spain', 2),
(5, 'Girona', 'Spain', 2),
(6, 'New York', 'USA', 3);

ALTER TABLE PLACE
  ADD CONSTRAINT PLACE_ibfk_1 FOREIGN KEY (ANNIVERSARYID) REFERENCES ANNIVERSARY (ANNIVERSARYID);

DROP TABLE IF EXISTS PLACEIMAGES;
CREATE TABLE IF NOT EXISTS PLACEIMAGES (
  PLACEIMAGEID int(11) NOT NULL AUTO_INCREMENT,
  PLACEIMAGEURL varchar(30) NOT NULL,
  PLACEIMAGETEXT varchar(30),
  PLACEID int(11) NOT NULL,
  PRIMARY KEY (PLACEIMAGEID)
) ENGINE=InnoDB AUTO_INCREMENT=13 DEFAULT CHARSET=utf8;

INSERT INTO PLACEIMAGES (PLACEIMAGEID, PLACEIMAGEURL, PLACEIMAGETEXT, PLACEID) VALUES
(1, 'Louvre1.jpg', 'Louvre', 1),
(2, 'Louvre2.jpg', 'Louvre', 1),
(3, 'London1.jpg', 'Royal Albert Hall', 2),
(4, 'Girona1.jpg', 'Girona', 5),
(5, 'Barcelona1.jpg', 'Camp Nou', 4),
(6, 'Barcelona2.jpg', 'Poble Espanol', 4),
(7, 'Barcelona3.jpg', 'Sagrada Familia', 4),
(8, 'Barcelona4.jpg', 'Poble Espanol', 4),
(9, 'NewYork1.jpg', 'Bleecker Street', 6),
(10, 'NewYork2.jpg', 'From The High Line', 6),
(11, 'NewYork3.jpg', 'Central Park', 6),
(12, 'NewYork4.jpg', 'Chrysler Building', 6);


DROP TABLE IF EXISTS anniversaryusers;
CREATE TABLE IF NOT EXISTS anniversaryusers (
  USERNAME varchar(15) COLLATE latin1_general_ci NOT NULL,
  USERPASSWORD varchar(512) COLLATE latin1_general_ci DEFAULT NULL,
  SALT varchar(1000) COLLATE latin1_general_ci DEFAULT NULL,
  USERROLE varchar(10) COLLATE latin1_general_ci DEFAULT NULL,
  PRIMARY KEY (USERNAME)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci;

INSERT INTO anniversaryusers (USERNAME, USERPASSWORD, SALT, USERROLE) VALUES
('Ciara', 'kwSFjoi0/qwMdjgumPHF3LOrkkRfRM1EEOjNP0PNew4pg0JzaqSQRb9E1LvsyyvA6KkxC7tOc7W7je27H/9nug==', 'e38z+N0HICgtNlMlc/qOWLhjdjmZOo9wqXmCgupTs6owjJVRWnD/a0hpVPhXkD+wBIewKZJSh0Haukg5JrewvNYBSnKa6S3uwAtF7IH2KXQNcrfigpJzAELoqg03UhDkBPmocbtK1kdTGfdMfMT/AaH0GzRS3uLq7I8EwmjWrEa1cKPgcnrYde3ogUdVT8wDhJ3coxKBGJVo8l8sPQkJTj5rvOKKZFwflpP/YPC5fUjnnKjUhYQs6GOMJQYpEIHGcIGHxEOB5kdpQaxuq+GFYBo5qwVEfTnjTCCOod7gK9k4F2SSfeWSPhIyLA5sd5KKPK2Fic9gLSqcx1ZhrsOsJRyWGpr8rcN5YcoVErk1jTAmpfSJ8DYan9F9pFFzOITqikcGOb7Yco7vyUv+8WdRk5PaEHcIBAi2XFAGKb21A377o5cVJIGa3LslFJNX22YToWBli7BiJ3djUULWSHgOQ4x9Jw56zxToMvzmxShKZ8Kzt5VlpcfhUXRrzleJRgv88Q/VvIX0l2VhR5jQyeIdu68YuOIAxRKTRSBhfLwJ2veGsQa+Q1sv02oXFm1bYqirKvMltxsZpE7GTina6ZbDrCifZT0t878ml8sIwBLDXpxoyIfhgYSzypbnoEO7s+cBXOS9wzu+HRo3IhCK1otU5rb8rULqwuAiuj1XxJnj/Qk=', 'USER'),
('Lynn', 'XaUHnJ7aVnSOTNoF+fD4NwIMOBxcKppUUDeFVqfDrhlEd9ZxLPnNbG2JZPy0P1cBd0RJFYGusqDAdvMO2m7E9A==', '8o6rL20oVamOUmmE+GgTjHaxRcoZflLgLAow/YJGLmCh5aChmTvtbIpQAWv01lZWhP08bc3hIcu2kHtJEV7em0+TxV8Hr0agWMbwldHY2vh6wXsd6QyT4GpkP/L4mCPjzUZzmRny1ugetaOZRm2inEN0TOhEN/xkuAWLFG4g4n0phiVZJNTx2OzulGauVxW1WRH2UjQYC5Lc8XI1vuEohmZIKbNOwPo0aG0dc29chPGPmM7cHsEL5shBnETN4JZJYEppKSULV2dE/Ycp5rBWIXB1VECTuHqPwP+OWiDzWKb4G7rpLc3AUNWJTzYFDvvcy0PJgqvHsYHfHqmgbmEWeV2RIRYIwcPXxzxEkEN1YiFRBbhZKPxlvw4T2RvHHMgMcEDGV37PyiRD/2xLVDqJk1QYBE6R+FI2pmbNavtmSorVq1ylkx79S5RGRPefsvXEqkzVn+KHjzCQ3UACAh4xf6T5bGTLDQweXWbPBViOjevhqDJKjpbvDuTI1UTtHyrhM8LEfSp18FaiWLoCYUTCGnFR81g58t0URTZyR3y6StogERQbBzbd9kzxlQLDlhW7UN6Y+z4qQ/pHljkk6vp0jUJTvccvLdmqZaQ1SDK42AgEMUMPror5njZuX/FivTDSFmXFltLsKUmeese0oFKiTN2BgAWvPJsV/Grao9iYv0c=', 'MANAGER'),
('Martin', 'sW97ylxVcwXS+PoWtHDlHTOQmhK2xz0Vh48hYUGPqzKGjNeW0XjgCgDzZv0xtpOMoYFLNc9uCFwh0f0S6TlFjA==', 'eTGbKJwWrjlKIMSOjLfSNj/B3yKrhQad0lJHfNB2DuL8C48kJ4tQpSTs+QdXw3ncyMZ3kSSvGPO06pjnY42ipmUyXGnIiCykKPQaP+JH9AFBCfHsPZQwZqBN9rg2rRWJP5V8xqBeDUz95B3bIlOCE+/DjYplM3dKf/4bWojsxq3uSsJiMHoikME9ntT3P+LsOdGM0YUFqpyv10ZaMSKZvdNUcAq1X+LsNlqbVx8oV3m+f2y2oOoJBL1XX6tVpQeWj12yy+YnhHGtehEKchTAT8JQyi1EDauzDw+X66OnfrkXowkLZQsMwRm5vpulvUAFyYO2IPig4U7YSIAwqy1VPJNvf68YfZzAx3ahyuNImnErdCKudL7/JeAm8yhOZTQIeKigCZpoATwU+RCp82lMLBRXrZe/PuAIAgFrpKOE0lbNqr8zBaBJjflMEX6B0n0QsjhPA91cEtpywVKFFrQ5U6ejIpuCOi02IMd2zJwHhM5llgp/kiT4spd5xsy5UEG02v7kMa9lZjeVA2GdG0bChrNLo1CPGXyabbzoYSTxA+8YRzra5GueETz4rrYkpTZ+IffC3fAmkZDj9UNxGf5GAhG9uR2LTkR6NnALKiWUYZhwMQn5YJyqnVbvpE/68hW2VtqyWdFbG3vrId6XCWw1LzwLuyW39LshRZvq/sWYzIY=', 'ADMIN'),
('Sergi', '6MpUfjwaOcbdfcxJS9Dt5Xd0ZUtLOQC3EX4CExAmhPwGkV5cQIEAGyHxCaXxdCXAfBN+0DM5Hm4BDKHRLuVzOw==', 'UzbIfrpq7gJWlJBkF75sEdkMBvULsJpu8eVrYJfvKfuhUOZtQAn8CU8ZWcwVJYmlel3qYRMw7Egc5PtGzhOpWoIU0F/NPoERqFNykwAsQ/PiAFfxskUUfPlhL4EBnkVJBMeERQjDHrP9bhrqI9X47VtZeWMj9LLoaygdMOmJbdOuWU+AEmBV+jXcia/6AaxyaHALabrOhyyC+il84THBhszbmYRZjRtX4N6/TsUhKDP7VoF0KcqpnSJEP7YfAm+jtxeQyNz7obAT78pMwlEL86/k2fwrXnS+T21sBxWtJj6cPEGtq1SBkVXw5AJodAkxkajeu1E7oBkmSpGns+H635KqeUYEKNkRL8wggFb0wwNSNPtTgry27PETVyuDOy+BHNVK0iNtGouACAOjeA7SHNJRTzWzel00UYfikGO/GWrgdMf12Qa5CM2YXy1hW1T+Z6SAN0NSL9INz6PKl+uoFl0Z7Fk5ofTZA2RI/Khw0SNRy3jsULBQ7CbwMurRaiMeZaylKD+9bi76BRNHuWftki9DQxI/RGVKKLaXTKr8zBVSevaVEjGS3+I9e6H+LHsd8rBBpQOxUunKpFjuOtamn8L0YEgr+KEUsO+blEJGKZQNDtBNWDk3LRwZSAYQGB9AYRUg5cbbTGSNL2LJ6XbVqnX2M3D5CykWZJe3pqVyNIU=', 'USER'),
('Xavi', 'Rm3scRQkNzVAismuX6iDWtf5cZ2TIVWjK/R7W+4fTXjCm4zswfmzbTql2bMtuizxTr7CUDDiwqPszIEGrlFpbQ==', 'j1jEkWb8XIK0nwCuLZ5k3HCj28oh5jnH5IAoXrjXn4kQpOJDYvbqcwaJ6zZ8bE354R4jLmlB5EeBC26H/8rwTxRgZXLa7WP641SLupAy7IsYl3t2m71j+NjMMpyirmUntN0j+uPKF655EOrhLQ7z7b3gSIgZzLUwA4CeqUwfyG88X6mhxwXYj3oRjgkVX+SmhE2Y172JvXEVSJSTKFriyx5ux0JAjBuvj0UfTzdQHxA3k96CTRXggvLW5x9Nvi4GOEzEin08eRXqpSSU2TyScKFFFfhVqi/u06gJYdRadhG23d4ZI+J7o9TJP+kArn49x2lkCbhIc8A4kK3J4d77SlDKJtbXLpZd5XMD6h5x7lUHSE80/WAO8IUy614HxjnMDgKzk7CftkzQVk0KlvT4wFXPFn4hRLGxnp6m0ji4v8VwxahWHOgC8FfBubOy+0CSlrMSaHQrvX83TX9MlqFmTN0oyaIMuF39YRSUOUVV6/LTosleo2lqjGN++5y9WNx2QXnlPjOh/Zk3M1767iCYasUO8U8ockghWMZG4kHLyDY/bwCeOIZRNFdYOVKNj16Si2dQAvAZuiBeNm/+fcUjqpFHkZjdKWZNLBhRUthG+8/vFVsgD6DRwZlITIRruY7X54nHG9gHWH9MXzazsl780kWR4VC9WcQsj9XuiWBbR18=', 'USER');



ALTER TABLE PLACEIMAGES
  ADD CONSTRAINT PLACEIMAGE_ibfk_1 FOREIGN KEY (PLACEID) REFERENCES PLACE (PLACEID);

  
DELIMITER $$
--
-- Procedures
--
DROP PROCEDURE IF EXISTS `AddAnniversary`$$
CREATE DEFINER=`root`@`localhost` PROCEDURE `AddAnniversary` (IN `inModernGift` TEXT, IN `inTradGift` TEXT)  BEGIN
 INSERT INTO ANNIVERSARY (MODERNGIFT, TRADGIFT)
        VALUES (inModernGift, inTradGift);
END$$

DROP PROCEDURE IF EXISTS `AddPlace`$$
CREATE DEFINER=`root`@`localhost` PROCEDURE `AddPlace` (IN `inPlaceName` TEXT, IN `inCountry` TEXT, IN `inAnniversaryId` INT)  BEGIN
 INSERT INTO PLACE (PLACENAME, COUNTRY, ANNIVERSARYID)
        VALUES (inPlaceName, inCountry, inAnniversaryId);
END$$

DROP PROCEDURE IF EXISTS `GetAnniversary`$$
CREATE DEFINER=`root`@`localhost` PROCEDURE `GetAnniversary` (IN `inAnniversaryId` INT)  BEGIN
 SELECT *
 FROM     ANNIVERSARY
 WHERE  ANNIVERSARYID = inAnniversaryId ;
END$$

DROP PROCEDURE IF EXISTS `GetAnniversaries`$$
CREATE DEFINER=`root`@`localhost` PROCEDURE `GetAnniversaries` ()  READS SQL DATA
BEGIN
  Select ANNIVERSARYID, MODERNGIFT, TRADGIFT From ANNIVERSARY Order By ANNIVERSARYID;    
END$$

DROP PROCEDURE IF EXISTS `GetAnniversaryPlaces`$$
CREATE DEFINER=`root`@`localhost` PROCEDURE `GetAnniversaryPlaces` (IN `inAnniversaryId` INT)  NO SQL
BEGIN
  SELECT PLACEID, PLACENAME, COUNTRY FROM PLACE
  WHERE ANNIVERSARYID = inAnniversaryId 
  Order By PLACENAME;
End$$

DROP PROCEDURE IF EXISTS `GetPlaceImages`$$
CREATE DEFINER=`root`@`localhost` PROCEDURE `GetPlaceImages` (IN `inPlaceId` INT)  NO SQL
BEGIN
  SELECT PLACEIMAGEURL, PLACEIMAGETEXT FROM PLACEIMAGES
  WHERE PLACEID = inPlaceId;
End$$

DROP PROCEDURE IF EXISTS `AddPlaceImage`$$
CREATE DEFINER=`root`@`localhost` PROCEDURE `AddPlaceImage` (IN `inPlaceImageURL` TEXT, IN `inPlaceImageText` TEXT, IN `inPlaceId` INT)  BEGIN
 INSERT INTO PLACEIMAGES (PLACEIMAGEURL, PLACEIMAGETEXT, PLACEID)
        VALUES (inPlaceImageURL, inPlaceImageText, inPlaceId);
END$$

DELIMITER ;  

